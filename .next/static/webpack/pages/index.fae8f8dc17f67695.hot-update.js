"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/index",{

/***/ "./lib/firestore.ts":
/*!**************************!*\
  !*** ./lib/firestore.ts ***!
  \**************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAllTeams: function() { return /* binding */ getAllTeams; },\n/* harmony export */   subscribeToTeams: function() { return /* binding */ subscribeToTeams; },\n/* harmony export */   updatePhysicalScore: function() { return /* binding */ updatePhysicalScore; }\n/* harmony export */ });\n/* harmony import */ var firebase_database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/database */ \"./node_modules/firebase/database/dist/esm/index.esm.js\");\n/* harmony import */ var _firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./firebase */ \"./lib/firebase.ts\");\n/* harmony import */ var firebase_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! firebase/auth */ \"./node_modules/firebase/auth/dist/esm/index.esm.js\");\n// Firebase Realtime Database operations for AR Treasure Hunt Volunteer Page\n\n\n\n/**\n * Ensure user is authenticated before database operations\n */ async function ensureAuth() {\n    if (!_firebase__WEBPACK_IMPORTED_MODULE_1__.auth.currentUser) {\n        try {\n            await (0,firebase_auth__WEBPACK_IMPORTED_MODULE_2__.signInAnonymously)(_firebase__WEBPACK_IMPORTED_MODULE_1__.auth);\n        } catch (error) {\n            console.error(\"Failed to authenticate anonymously:\", error);\n            throw new Error(\"Authentication required\");\n        }\n    }\n}\n/**\n * Get session data for a team\n */ async function getTeamSession(uid) {\n    try {\n        // Try lowercase 'session' first (matches main code)\n        const sessionRef = (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.ref)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"\".concat(uid, \"/session\"));\n        const snapshot = await (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.get)(sessionRef);\n        if (snapshot.exists()) {\n            return snapshot.val();\n        }\n        // Fallback to uppercase 'Session' for backwards compatibility\n        const sessionRefUpper = (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.ref)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"\".concat(uid, \"/Session\"));\n        const snapshotUpper = await (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.get)(sessionRefUpper);\n        if (snapshotUpper.exists()) {\n            return snapshotUpper.val();\n        }\n        return null;\n    } catch (error) {\n        console.error(\"Error getting team session:\", error);\n        return null;\n    }\n}\n/**\n * Get all teams for the volunteer interface\n */ async function getAllTeams() {\n    try {\n        await ensureAuth();\n        const rootRef = (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.ref)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db);\n        const snapshot = await (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.get)(rootRef);\n        if (!snapshot.exists()) {\n            return [];\n        }\n        const allData = snapshot.val();\n        const teamsArray = [];\n        console.log(\"Raw Firebase data:\", allData);\n        // Filter only valid team nodes (those with teamName property)\n        for(const uid in allData){\n            if (allData[uid] && typeof allData[uid] === \"object\" && allData[uid].teamName) {\n                const rawTeamData = allData[uid];\n                console.log(\"Processing team \".concat(uid, \":\"), rawTeamData);\n                // Create team data without the Session node first\n                const teamData = {\n                    ...rawTeamData\n                };\n                teamData.uid = uid; // Ensure UID is set\n                // Ensure physicalScore and comment are included\n                teamData.physicalScore = teamData.physicalScore || 0;\n                teamData.physicalScoreComment = teamData.physicalScoreComment || \"\";\n                // Check if session data exists as a nested object (try multiple field names)\n                if (rawTeamData.session && typeof rawTeamData.session === \"object\") {\n                    console.log(\"Found session data for team \".concat(uid, \":\"), rawTeamData.session);\n                    teamData.session = rawTeamData.session;\n                } else if (rawTeamData.Session && typeof rawTeamData.Session === \"object\") {\n                    console.log(\"Found Session data (uppercase) for team \".concat(uid, \":\"), rawTeamData.Session);\n                    teamData.session = rawTeamData.Session;\n                } else {\n                    console.log(\"No session data found for team \".concat(uid, \", checking for alternative session data...\"));\n                    console.log(\"Available keys in team data:\", Object.keys(rawTeamData));\n                    // Check if there are any session-related fields directly on the team object\n                    const potentialSessionFields = [\n                        \"currentClueNumber\",\n                        \"cluesCompleted\",\n                        \"gameStarted\",\n                        \"started\",\n                        \"status\"\n                    ];\n                    const foundFields = {};\n                    let hasSessionData = false;\n                    for (const field of potentialSessionFields){\n                        if (rawTeamData[field] !== undefined) {\n                            foundFields[field] = rawTeamData[field];\n                            hasSessionData = true;\n                        }\n                    }\n                    if (hasSessionData) {\n                        console.log(\"Found session-related fields directly on team \".concat(uid, \":\"), foundFields);\n                        teamData.session = foundFields;\n                    } else {\n                        // Default session data for teams that haven't started\n                        teamData.session = {\n                            cluesCompleted: 0,\n                            currentClueNumber: 0,\n                            started: false,\n                            status: \"not_started\"\n                        };\n                    }\n                }\n                console.log(\"Final processed team data for \".concat(uid, \":\"), teamData);\n                teamsArray.push(teamData);\n            } else {\n                console.log(\"Skipping invalid team data for \".concat(uid, \":\"), allData[uid]);\n            }\n        }\n        // Sort by team number (ascending)\n        teamsArray.sort((a, b)=>a.teamNumber - b.teamNumber);\n        return teamsArray;\n    } catch (error) {\n        console.error(\"Error getting teams:\", error);\n        return [];\n    }\n}\n/**\n * Update a team's physical score with comment\n */ async function updatePhysicalScore(uid, physicalScore, comment) {\n    try {\n        await ensureAuth();\n        const teamRef = (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.ref)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, uid);\n        const snapshot = await (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.get)(teamRef);\n        if (!snapshot.exists()) {\n            throw new Error(\"Team not found with the provided UID\");\n        }\n        // Update the physical score and comment\n        const updateData = {\n            physicalScore: physicalScore\n        };\n        if (comment !== undefined) {\n            updateData.physicalScoreComment = comment;\n        }\n        await (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.update)(teamRef, updateData);\n        return true;\n    } catch (error) {\n        console.error(\"Error updating physical score:\", error);\n        throw error;\n    }\n}\n/**\n * Set up real-time listener for team updates\n */ function subscribeToTeams(callback) {\n    try {\n        const rootRef = (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.ref)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db);\n        console.log(\"Setting up Realtime Database listener for teams...\");\n        const unsubscribe = (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.onValue)(rootRef, (snapshot)=>{\n            console.log(\"Realtime Database snapshot received\");\n            if (!snapshot.exists()) {\n                console.log(\"No data found\");\n                callback([]);\n                return;\n            }\n            const allData = snapshot.val();\n            const teamsArray = [];\n            // Filter only valid team nodes (those with teamName property)\n            for(const uid in allData){\n                if (allData[uid] && typeof allData[uid] === \"object\" && allData[uid].teamName) {\n                    const rawTeamData = allData[uid];\n                    console.log(\"Real-time: Processing team \".concat(uid, \":\"), rawTeamData);\n                    // Create team data without the Session node first\n                    const teamData = {\n                        ...rawTeamData\n                    };\n                    teamData.uid = uid; // Ensure UID is set\n                    // Ensure physicalScore and comment are included\n                    teamData.physicalScore = teamData.physicalScore || 0;\n                    teamData.physicalScoreComment = teamData.physicalScoreComment || \"\";\n                    // Handle session data from the snapshot (lowercase 's')\n                    if (rawTeamData.session && typeof rawTeamData.session === \"object\") {\n                        console.log(\"Real-time: Found session data for team \".concat(uid, \":\"), rawTeamData.session);\n                        teamData.session = rawTeamData.session;\n                    } else {\n                        console.log(\"Real-time: No session data found for team \".concat(uid));\n                        console.log(\"Real-time: Available keys in team data:\", Object.keys(rawTeamData));\n                        // Default session data for teams that haven't started\n                        teamData.session = {\n                            cluesCompleted: 0,\n                            currentClueNumber: 0,\n                            started: false,\n                            status: \"not_started\"\n                        };\n                    }\n                    console.log(\"Real-time: Final processed team data for \".concat(uid, \":\"), teamData);\n                    teamsArray.push(teamData);\n                } else {\n                    console.log(\"Real-time: Skipping invalid team data for \".concat(uid, \":\"), allData[uid]);\n                }\n            }\n            console.log(\"Teams data:\", teamsArray);\n            // Sort by team number (ascending)\n            teamsArray.sort((a, b)=>a.teamNumber - b.teamNumber);\n            callback(teamsArray);\n        }, (error)=>{\n            console.error(\"Realtime Database listener error:\", error);\n            callback([]);\n        });\n        // Return unsubscribe function\n        return ()=>{\n            console.log(\"Unsubscribing from Realtime Database listener\");\n            (0,firebase_database__WEBPACK_IMPORTED_MODULE_0__.off)(rootRef, \"value\", unsubscribe);\n        };\n    } catch (error) {\n        console.error(\"Error setting up Realtime Database listener:\", error);\n        return ()=>{};\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxDQUFDZDtZQUNDQyxRQUFRRCxLQUFLLENBQUMscUNBQXFDQTtZQUNuRDRDLFNBQVMsRUFBRTtRQUNiO1FBR0YsOEJBQThCO1FBQzlCLE9BQU87WUFDTDNDLFFBQVFjLEdBQUcsQ0FBQztZQUNackIsc0RBQUdBLENBQUNrQixTQUFTLFNBQVNpQztRQUN4QjtJQUNGLEVBQUUsT0FBTzdDLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGdEQUFnREE7UUFDOUQsT0FBTyxLQUFPO0lBQ2hCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbGliL2ZpcmVzdG9yZS50cz9iNDZlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEZpcmViYXNlIFJlYWx0aW1lIERhdGFiYXNlIG9wZXJhdGlvbnMgZm9yIEFSIFRyZWFzdXJlIEh1bnQgVm9sdW50ZWVyIFBhZ2VcblxuaW1wb3J0IHtcbiAgcmVmLFxuICBnZXQsXG4gIHVwZGF0ZSxcbiAgb25WYWx1ZSxcbiAgb2ZmXG59IGZyb20gJ2ZpcmViYXNlL2RhdGFiYXNlJztcbmltcG9ydCB7IGRiLCBhdXRoIH0gZnJvbSAnLi9maXJlYmFzZSc7XG5pbXBvcnQgeyBzaWduSW5Bbm9ueW1vdXNseSB9IGZyb20gJ2ZpcmViYXNlL2F1dGgnO1xuXG4vLyBEZWZpbmUgdGhlIFNlc3Npb24gaW50ZXJmYWNlIGZvciB0ZWFtIHByb2dyZXNzXG5leHBvcnQgaW50ZXJmYWNlIFNlc3Npb24ge1xuICAvLyBBY3R1YWwgZmllbGQgbmFtZXMgZnJvbSB5b3VyIEZpcmViYXNlIHN0cnVjdHVyZVxuICBjbHVlc0NvbXBsZXRlZD86IG51bWJlcjtcbiAgY3VycmVudENsdWVOdW1iZXI/OiBudW1iZXI7XG4gIHN0YXJ0ZWQ/OiBib29sZWFuO1xuICBcbiAgLy8gTGVnYWN5L2FsdGVybmF0aXZlIGZpZWxkIG5hbWVzIGZvciBjb21wYXRpYmlsaXR5XG4gIGN1cnJlbnRDbHVlPzogbnVtYmVyO1xuICBjbHVlc1NvbHZlZD86IG51bWJlcjtcbiAgdG90YWxDbHVlcz86IG51bWJlcjtcbiAgdGltZVN0YXJ0ZWQ/OiBudW1iZXI7XG4gIGxhc3RBY3Rpdml0eT86IG51bWJlcjtcbiAgc3RhdHVzPzogc3RyaW5nO1xuICBwcm9ncmVzc01ldHJpY3M/OiB7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xuICBjdXJyZW50TGV2ZWw/OiBudW1iZXI7XG4gIGdhbWVTdGFydGVkPzogYm9vbGVhbjtcbiAgaXNBY3RpdmU/OiBib29sZWFuO1xuICBsYXN0Q2x1ZVRpbWU/OiBudW1iZXI7XG4gIFtrZXk6IHN0cmluZ106IGFueTsgLy8gQWxsb3cgZm9yIGFueSBhZGRpdGlvbmFsIGZpZWxkc1xufVxuXG4vLyBEZWZpbmUgdGhlIFRlYW0gaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIFRlYW0ge1xuICB1aWQ6IHN0cmluZztcbiAgdGVhbU51bWJlcjogbnVtYmVyO1xuICB0ZWFtTmFtZTogc3RyaW5nO1xuICBwbGF5ZXIxOiBzdHJpbmc7XG4gIHBsYXllcjI6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgcGhvbmVOdW1iZXI6IHN0cmluZztcbiAgc2NvcmU6IG51bWJlcjtcbiAgcGh5c2ljYWxTY29yZT86IG51bWJlcjtcbiAgcGh5c2ljYWxTY29yZUNvbW1lbnQ/OiBzdHJpbmc7IC8vIENvbW1lbnQgZmllbGQgZm9yIHBoeXNpY2FsIHNjb3JlXG4gIGNyZWF0ZWRBdDogbnVtYmVyO1xuICBzZXNzaW9uPzogU2Vzc2lvbjsgLy8gU2Vzc2lvbiBkYXRhIGZvciBwcm9ncmVzcyB0cmFja2luZ1xufVxuXG4vKipcbiAqIEVuc3VyZSB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgYmVmb3JlIGRhdGFiYXNlIG9wZXJhdGlvbnNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZW5zdXJlQXV0aCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFhdXRoLmN1cnJlbnRVc2VyKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHNpZ25JbkFub255bW91c2x5KGF1dGgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gYXV0aGVudGljYXRlIGFub255bW91c2x5OicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXV0aGVudGljYXRpb24gcmVxdWlyZWQnKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgc2Vzc2lvbiBkYXRhIGZvciBhIHRlYW1cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0VGVhbVNlc3Npb24odWlkOiBzdHJpbmcpOiBQcm9taXNlPFNlc3Npb24gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgLy8gVHJ5IGxvd2VyY2FzZSAnc2Vzc2lvbicgZmlyc3QgKG1hdGNoZXMgbWFpbiBjb2RlKVxuICAgIGNvbnN0IHNlc3Npb25SZWYgPSByZWYoZGIsIGAke3VpZH0vc2Vzc2lvbmApO1xuICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0KHNlc3Npb25SZWYpO1xuICAgIFxuICAgIGlmIChzbmFwc2hvdC5leGlzdHMoKSkge1xuICAgICAgcmV0dXJuIHNuYXBzaG90LnZhbCgpIGFzIFNlc3Npb247XG4gICAgfVxuICAgIFxuICAgIC8vIEZhbGxiYWNrIHRvIHVwcGVyY2FzZSAnU2Vzc2lvbicgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5XG4gICAgY29uc3Qgc2Vzc2lvblJlZlVwcGVyID0gcmVmKGRiLCBgJHt1aWR9L1Nlc3Npb25gKTtcbiAgICBjb25zdCBzbmFwc2hvdFVwcGVyID0gYXdhaXQgZ2V0KHNlc3Npb25SZWZVcHBlcik7XG4gICAgXG4gICAgaWYgKHNuYXBzaG90VXBwZXIuZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybiBzbmFwc2hvdFVwcGVyLnZhbCgpIGFzIFNlc3Npb247XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdGVhbSBzZXNzaW9uOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhbGwgdGVhbXMgZm9yIHRoZSB2b2x1bnRlZXIgaW50ZXJmYWNlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxUZWFtcygpOiBQcm9taXNlPFRlYW1bXT4ge1xuICB0cnkge1xuICAgIGF3YWl0IGVuc3VyZUF1dGgoKTtcbiAgICBjb25zdCByb290UmVmID0gcmVmKGRiKTtcbiAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldChyb290UmVmKTtcbiAgICBcbiAgICBpZiAoIXNuYXBzaG90LmV4aXN0cygpKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgY29uc3QgYWxsRGF0YSA9IHNuYXBzaG90LnZhbCgpO1xuICAgIGNvbnN0IHRlYW1zQXJyYXk6IFRlYW1bXSA9IFtdO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdSYXcgRmlyZWJhc2UgZGF0YTonLCBhbGxEYXRhKTtcbiAgICBcbiAgICAvLyBGaWx0ZXIgb25seSB2YWxpZCB0ZWFtIG5vZGVzICh0aG9zZSB3aXRoIHRlYW1OYW1lIHByb3BlcnR5KVxuICAgIGZvciAoY29uc3QgdWlkIGluIGFsbERhdGEpIHtcbiAgICAgIGlmIChhbGxEYXRhW3VpZF0gJiYgdHlwZW9mIGFsbERhdGFbdWlkXSA9PT0gJ29iamVjdCcgJiYgYWxsRGF0YVt1aWRdLnRlYW1OYW1lKSB7XG4gICAgICAgIGNvbnN0IHJhd1RlYW1EYXRhID0gYWxsRGF0YVt1aWRdO1xuICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyB0ZWFtICR7dWlkfTpgLCByYXdUZWFtRGF0YSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgdGVhbSBkYXRhIHdpdGhvdXQgdGhlIFNlc3Npb24gbm9kZSBmaXJzdFxuICAgICAgICBjb25zdCB0ZWFtRGF0YSA9IHsgLi4ucmF3VGVhbURhdGEgfSBhcyBUZWFtO1xuICAgICAgICB0ZWFtRGF0YS51aWQgPSB1aWQ7IC8vIEVuc3VyZSBVSUQgaXMgc2V0XG4gICAgICAgIFxuICAgICAgICAvLyBFbnN1cmUgcGh5c2ljYWxTY29yZSBhbmQgY29tbWVudCBhcmUgaW5jbHVkZWRcbiAgICAgICAgdGVhbURhdGEucGh5c2ljYWxTY29yZSA9IHRlYW1EYXRhLnBoeXNpY2FsU2NvcmUgfHwgMDtcbiAgICAgICAgdGVhbURhdGEucGh5c2ljYWxTY29yZUNvbW1lbnQgPSB0ZWFtRGF0YS5waHlzaWNhbFNjb3JlQ29tbWVudCB8fCAnJztcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIHNlc3Npb24gZGF0YSBleGlzdHMgYXMgYSBuZXN0ZWQgb2JqZWN0ICh0cnkgbXVsdGlwbGUgZmllbGQgbmFtZXMpXG4gICAgICAgIGlmIChyYXdUZWFtRGF0YS5zZXNzaW9uICYmIHR5cGVvZiByYXdUZWFtRGF0YS5zZXNzaW9uID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBGb3VuZCBzZXNzaW9uIGRhdGEgZm9yIHRlYW0gJHt1aWR9OmAsIHJhd1RlYW1EYXRhLnNlc3Npb24pO1xuICAgICAgICAgIHRlYW1EYXRhLnNlc3Npb24gPSByYXdUZWFtRGF0YS5zZXNzaW9uIGFzIFNlc3Npb247XG4gICAgICAgIH0gZWxzZSBpZiAocmF3VGVhbURhdGEuU2Vzc2lvbiAmJiB0eXBlb2YgcmF3VGVhbURhdGEuU2Vzc2lvbiA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgRm91bmQgU2Vzc2lvbiBkYXRhICh1cHBlcmNhc2UpIGZvciB0ZWFtICR7dWlkfTpgLCByYXdUZWFtRGF0YS5TZXNzaW9uKTtcbiAgICAgICAgICB0ZWFtRGF0YS5zZXNzaW9uID0gcmF3VGVhbURhdGEuU2Vzc2lvbiBhcyBTZXNzaW9uO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBObyBzZXNzaW9uIGRhdGEgZm91bmQgZm9yIHRlYW0gJHt1aWR9LCBjaGVja2luZyBmb3IgYWx0ZXJuYXRpdmUgc2Vzc2lvbiBkYXRhLi4uYCk7XG4gICAgICAgICAgY29uc29sZS5sb2coYEF2YWlsYWJsZSBrZXlzIGluIHRlYW0gZGF0YTpgLCBPYmplY3Qua2V5cyhyYXdUZWFtRGF0YSkpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGFyZSBhbnkgc2Vzc2lvbi1yZWxhdGVkIGZpZWxkcyBkaXJlY3RseSBvbiB0aGUgdGVhbSBvYmplY3RcbiAgICAgICAgICBjb25zdCBwb3RlbnRpYWxTZXNzaW9uRmllbGRzID0gWydjdXJyZW50Q2x1ZU51bWJlcicsICdjbHVlc0NvbXBsZXRlZCcsICdnYW1lU3RhcnRlZCcsICdzdGFydGVkJywgJ3N0YXR1cyddO1xuICAgICAgICAgIGNvbnN0IGZvdW5kRmllbGRzOiBhbnkgPSB7fTtcbiAgICAgICAgICBsZXQgaGFzU2Vzc2lvbkRhdGEgPSBmYWxzZTtcbiAgICAgICAgICBcbiAgICAgICAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIHBvdGVudGlhbFNlc3Npb25GaWVsZHMpIHtcbiAgICAgICAgICAgIGlmIChyYXdUZWFtRGF0YVtmaWVsZF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICBmb3VuZEZpZWxkc1tmaWVsZF0gPSByYXdUZWFtRGF0YVtmaWVsZF07XG4gICAgICAgICAgICAgIGhhc1Nlc3Npb25EYXRhID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGhhc1Nlc3Npb25EYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRm91bmQgc2Vzc2lvbi1yZWxhdGVkIGZpZWxkcyBkaXJlY3RseSBvbiB0ZWFtICR7dWlkfTpgLCBmb3VuZEZpZWxkcyk7XG4gICAgICAgICAgICB0ZWFtRGF0YS5zZXNzaW9uID0gZm91bmRGaWVsZHMgYXMgU2Vzc2lvbjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRGVmYXVsdCBzZXNzaW9uIGRhdGEgZm9yIHRlYW1zIHRoYXQgaGF2ZW4ndCBzdGFydGVkXG4gICAgICAgICAgICB0ZWFtRGF0YS5zZXNzaW9uID0ge1xuICAgICAgICAgICAgICBjbHVlc0NvbXBsZXRlZDogMCxcbiAgICAgICAgICAgICAgY3VycmVudENsdWVOdW1iZXI6IDAsXG4gICAgICAgICAgICAgIHN0YXJ0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICBzdGF0dXM6ICdub3Rfc3RhcnRlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgRmluYWwgcHJvY2Vzc2VkIHRlYW0gZGF0YSBmb3IgJHt1aWR9OmAsIHRlYW1EYXRhKTtcbiAgICAgICAgdGVhbXNBcnJheS5wdXNoKHRlYW1EYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBTa2lwcGluZyBpbnZhbGlkIHRlYW0gZGF0YSBmb3IgJHt1aWR9OmAsIGFsbERhdGFbdWlkXSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFNvcnQgYnkgdGVhbSBudW1iZXIgKGFzY2VuZGluZylcbiAgICB0ZWFtc0FycmF5LnNvcnQoKGEsIGIpID0+IGEudGVhbU51bWJlciAtIGIudGVhbU51bWJlcik7XG4gICAgXG4gICAgcmV0dXJuIHRlYW1zQXJyYXk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB0ZWFtczonLCBlcnJvcik7XG4gICAgcmV0dXJuIFtdO1xuICB9XG59XG5cbi8qKlxuICogVXBkYXRlIGEgdGVhbSdzIHBoeXNpY2FsIHNjb3JlIHdpdGggY29tbWVudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUGh5c2ljYWxTY29yZSh1aWQ6IHN0cmluZywgcGh5c2ljYWxTY29yZTogbnVtYmVyLCBjb21tZW50Pzogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZW5zdXJlQXV0aCgpO1xuICAgIGNvbnN0IHRlYW1SZWYgPSByZWYoZGIsIHVpZCk7XG4gICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCBnZXQodGVhbVJlZik7XG4gICAgXG4gICAgaWYgKCFzbmFwc2hvdC5leGlzdHMoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZWFtIG5vdCBmb3VuZCB3aXRoIHRoZSBwcm92aWRlZCBVSUQnKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgdGhlIHBoeXNpY2FsIHNjb3JlIGFuZCBjb21tZW50XG4gICAgY29uc3QgdXBkYXRlRGF0YTogYW55ID0ge1xuICAgICAgcGh5c2ljYWxTY29yZTogcGh5c2ljYWxTY29yZVxuICAgIH07XG4gICAgXG4gICAgaWYgKGNvbW1lbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlRGF0YS5waHlzaWNhbFNjb3JlQ29tbWVudCA9IGNvbW1lbnQ7XG4gICAgfVxuXG4gICAgYXdhaXQgdXBkYXRlKHRlYW1SZWYsIHVwZGF0ZURhdGEpO1xuXG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgcGh5c2ljYWwgc2NvcmU6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICogU2V0IHVwIHJlYWwtdGltZSBsaXN0ZW5lciBmb3IgdGVhbSB1cGRhdGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdWJzY3JpYmVUb1RlYW1zKGNhbGxiYWNrOiAodGVhbXM6IFRlYW1bXSkgPT4gdm9pZCk6ICgpID0+IHZvaWQge1xuICB0cnkge1xuICAgIGNvbnN0IHJvb3RSZWYgPSByZWYoZGIpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdTZXR0aW5nIHVwIFJlYWx0aW1lIERhdGFiYXNlIGxpc3RlbmVyIGZvciB0ZWFtcy4uLicpO1xuICAgIFxuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gb25WYWx1ZShyb290UmVmLCBcbiAgICAgIChzbmFwc2hvdCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnUmVhbHRpbWUgRGF0YWJhc2Ugc25hcHNob3QgcmVjZWl2ZWQnKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghc25hcHNob3QuZXhpc3RzKCkpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnTm8gZGF0YSBmb3VuZCcpO1xuICAgICAgICAgIGNhbGxiYWNrKFtdKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhbGxEYXRhID0gc25hcHNob3QudmFsKCk7XG4gICAgICAgIGNvbnN0IHRlYW1zQXJyYXk6IFRlYW1bXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsdGVyIG9ubHkgdmFsaWQgdGVhbSBub2RlcyAodGhvc2Ugd2l0aCB0ZWFtTmFtZSBwcm9wZXJ0eSlcbiAgICAgICAgZm9yIChjb25zdCB1aWQgaW4gYWxsRGF0YSkge1xuICAgICAgICAgIGlmIChhbGxEYXRhW3VpZF0gJiYgdHlwZW9mIGFsbERhdGFbdWlkXSA9PT0gJ29iamVjdCcgJiYgYWxsRGF0YVt1aWRdLnRlYW1OYW1lKSB7XG4gICAgICAgICAgICBjb25zdCByYXdUZWFtRGF0YSA9IGFsbERhdGFbdWlkXTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBSZWFsLXRpbWU6IFByb2Nlc3NpbmcgdGVhbSAke3VpZH06YCwgcmF3VGVhbURhdGEpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhdGUgdGVhbSBkYXRhIHdpdGhvdXQgdGhlIFNlc3Npb24gbm9kZSBmaXJzdFxuICAgICAgICAgICAgY29uc3QgdGVhbURhdGEgPSB7IC4uLnJhd1RlYW1EYXRhIH0gYXMgVGVhbTtcbiAgICAgICAgICAgIHRlYW1EYXRhLnVpZCA9IHVpZDsgLy8gRW5zdXJlIFVJRCBpcyBzZXRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRW5zdXJlIHBoeXNpY2FsU2NvcmUgYW5kIGNvbW1lbnQgYXJlIGluY2x1ZGVkXG4gICAgICAgICAgICB0ZWFtRGF0YS5waHlzaWNhbFNjb3JlID0gdGVhbURhdGEucGh5c2ljYWxTY29yZSB8fCAwO1xuICAgICAgICAgICAgdGVhbURhdGEucGh5c2ljYWxTY29yZUNvbW1lbnQgPSB0ZWFtRGF0YS5waHlzaWNhbFNjb3JlQ29tbWVudCB8fCAnJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSGFuZGxlIHNlc3Npb24gZGF0YSBmcm9tIHRoZSBzbmFwc2hvdCAobG93ZXJjYXNlICdzJylcbiAgICAgICAgICAgIGlmIChyYXdUZWFtRGF0YS5zZXNzaW9uICYmIHR5cGVvZiByYXdUZWFtRGF0YS5zZXNzaW9uID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUmVhbC10aW1lOiBGb3VuZCBzZXNzaW9uIGRhdGEgZm9yIHRlYW0gJHt1aWR9OmAsIHJhd1RlYW1EYXRhLnNlc3Npb24pO1xuICAgICAgICAgICAgICB0ZWFtRGF0YS5zZXNzaW9uID0gcmF3VGVhbURhdGEuc2Vzc2lvbiBhcyBTZXNzaW9uO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYFJlYWwtdGltZTogTm8gc2Vzc2lvbiBkYXRhIGZvdW5kIGZvciB0ZWFtICR7dWlkfWApO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUmVhbC10aW1lOiBBdmFpbGFibGUga2V5cyBpbiB0ZWFtIGRhdGE6YCwgT2JqZWN0LmtleXMocmF3VGVhbURhdGEpKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIERlZmF1bHQgc2Vzc2lvbiBkYXRhIGZvciB0ZWFtcyB0aGF0IGhhdmVuJ3Qgc3RhcnRlZFxuICAgICAgICAgICAgICB0ZWFtRGF0YS5zZXNzaW9uID0ge1xuICAgICAgICAgICAgICAgIGNsdWVzQ29tcGxldGVkOiAwLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRDbHVlTnVtYmVyOiAwLFxuICAgICAgICAgICAgICAgIHN0YXJ0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN0YXR1czogJ25vdF9zdGFydGVkJ1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgUmVhbC10aW1lOiBGaW5hbCBwcm9jZXNzZWQgdGVhbSBkYXRhIGZvciAke3VpZH06YCwgdGVhbURhdGEpO1xuICAgICAgICAgICAgdGVhbXNBcnJheS5wdXNoKHRlYW1EYXRhKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFJlYWwtdGltZTogU2tpcHBpbmcgaW52YWxpZCB0ZWFtIGRhdGEgZm9yICR7dWlkfTpgLCBhbGxEYXRhW3VpZF0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coJ1RlYW1zIGRhdGE6JywgdGVhbXNBcnJheSk7XG4gICAgICAgIFxuICAgICAgICAvLyBTb3J0IGJ5IHRlYW0gbnVtYmVyIChhc2NlbmRpbmcpXG4gICAgICAgIHRlYW1zQXJyYXkuc29ydCgoYSwgYikgPT4gYS50ZWFtTnVtYmVyIC0gYi50ZWFtTnVtYmVyKTtcbiAgICAgICAgXG4gICAgICAgIGNhbGxiYWNrKHRlYW1zQXJyYXkpO1xuICAgICAgfSxcbiAgICAgIChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdSZWFsdGltZSBEYXRhYmFzZSBsaXN0ZW5lciBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgIGNhbGxiYWNrKFtdKTtcbiAgICAgIH1cbiAgICApO1xuXG4gICAgLy8gUmV0dXJuIHVuc3Vic2NyaWJlIGZ1bmN0aW9uXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdVbnN1YnNjcmliaW5nIGZyb20gUmVhbHRpbWUgRGF0YWJhc2UgbGlzdGVuZXInKTtcbiAgICAgIG9mZihyb290UmVmLCAndmFsdWUnLCB1bnN1YnNjcmliZSk7XG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIHVwIFJlYWx0aW1lIERhdGFiYXNlIGxpc3RlbmVyOicsIGVycm9yKTtcbiAgICByZXR1cm4gKCkgPT4ge307XG4gIH1cbn0iXSwibmFtZXMiOlsicmVmIiwiZ2V0IiwidXBkYXRlIiwib25WYWx1ZSIsIm9mZiIsImRiIiwiYXV0aCIsInNpZ25JbkFub255bW91c2x5IiwiZW5zdXJlQXV0aCIsImN1cnJlbnRVc2VyIiwiZXJyb3IiLCJjb25zb2xlIiwiRXJyb3IiLCJnZXRUZWFtU2Vzc2lvbiIsInVpZCIsInNlc3Npb25SZWYiLCJzbmFwc2hvdCIsImV4aXN0cyIsInZhbCIsInNlc3Npb25SZWZVcHBlciIsInNuYXBzaG90VXBwZXIiLCJnZXRBbGxUZWFtcyIsInJvb3RSZWYiLCJhbGxEYXRhIiwidGVhbXNBcnJheSIsImxvZyIsInRlYW1OYW1lIiwicmF3VGVhbURhdGEiLCJ0ZWFtRGF0YSIsInBoeXNpY2FsU2NvcmUiLCJwaHlzaWNhbFNjb3JlQ29tbWVudCIsInNlc3Npb24iLCJTZXNzaW9uIiwiT2JqZWN0Iiwia2V5cyIsInBvdGVudGlhbFNlc3Npb25GaWVsZHMiLCJmb3VuZEZpZWxkcyIsImhhc1Nlc3Npb25EYXRhIiwiZmllbGQiLCJ1bmRlZmluZWQiLCJjbHVlc0NvbXBsZXRlZCIsImN1cnJlbnRDbHVlTnVtYmVyIiwic3RhcnRlZCIsInN0YXR1cyIsInB1c2giLCJzb3J0IiwiYSIsImIiLCJ0ZWFtTnVtYmVyIiwidXBkYXRlUGh5c2ljYWxTY29yZSIsImNvbW1lbnQiLCJ0ZWFtUmVmIiwidXBkYXRlRGF0YSIsInN1YnNjcmliZVRvVGVhbXMiLCJjYWxsYmFjayIsInVuc3Vic2NyaWJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/firestore.ts\n"));

/***/ })

});